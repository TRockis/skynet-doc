# 5.2 ELK集成

## kafka安装

#### 解压文件

```bash
tar -zxvf  kafka_2.10-0.10.1.0.tar.gz
```

下面是解压后的文件目录

![](../.gitbook/assets/image%20%2825%29.png)

#### 修改配置文件

```bash
vim config/server.properties
```

 修改kafka/config/server.properties中的IP和zk连接的IP

![](../.gitbook/assets/image%20%2826%29.png)

![](../.gitbook/assets/image%20%2823%29.png)

#### 启动kafka

```bash
./kafkaStart.sh
```

## kafka-manager安装

文件解压

```bash
tar -zxvf kafka-manager-1.3.1.8.tar.gz
```

kafka-manager-1.3.1.8.tar.gz解压后目录如下图所示

![](../.gitbook/assets/image%20%2810%29.png)

**修改配置**

```text
vim kafka.sh
```

 直接修改kafka-manager/ kafka.sh中的zk配置就行,修改为你使用zk的地址和端口

![](../.gitbook/assets/image%20%2828%29.png)

**启动kafka-manager**

```bash
./kfkStart.sh
```

 访问地址：[http://IP:9000](http://IP:9000)

 出现下图说明kafka-manager启动成功

![](../.gitbook/assets/image%20%2829%29.png)

 选择”Cluster“—&gt;"Add Cluster"，输入zk地址，**其他配置默认勾选即可**

![](../.gitbook/assets/image%20%2822%29.png)

 点击save，就能看到配置后的kafka了

![](../.gitbook/assets/image%20%2811%29.png)

## ELK安装

#### **文件解压** {#a.部署手册-ELK-2.1解压}

 安装ELK，将elk-5.4.0.tar.gz文件拷贝到/iflytek/server下，解压：

```bash
tar -zxvf  elk-5.4.0.tar.gz
```

 elk-5.4.0.tar.gz解压后目录如下图所示

![](../.gitbook/assets/image%20%285%29.png)

#### **部署启动ELK** {#a.部署手册-ELK-2.2部署启动ELK}

![](../.gitbook/assets/image%20%2818%29.png)

**安装ELK配置（仅第一次需要）**

```bash
#   ./elk.sh setup
 begin inti env -------------------
 add user elastic ...
groupadd: group 'elastic' already exists
useradd: user 'elastic' already exists
 add user ok.-------------------
 config node npm grunt ...
nodejs.version: v6.11.0
npm.version: 3.10.10
grunt.version: grunt-cli v1.2.0
config node npm grunt ok.------------------
   
 config es host:192.168.83.206 port:9230 ...
 config es host and port ok.----------
   
 config es head ...
 config es head: http://192.168.83.206:9130 ok.
 config esql ...
 config esql http://192.168.83.206:9430 ok.
   
 config kibana ...
 config kibana ok.
 config finished.-----------------
```

**启动ELK**

```bash
[root@skynetant elk-5.4.0]# ./elk.sh start
 ===========================================
 -- ELK 5.4.0  start ..                   --
 -------------------------------------------
 Starting elasticsearch  ...  
 The elasticsearch service is started: http://192.168.83.206:9230
 Starting header  ...  
 The elasticsearch header is started: http://192.168.83.206:9130
 Starting esql  ...  
 The elasticsearch sql is started: http://192.168.83.206:9430
 Starting kibana  ...  
 The kibana service is started: http://192.168.83.206:5631
 Starting logstash  ...  
 The logstash service is started.
 -------------------------------------------
 elasticsearch pid:
 header pid:12625
 esql pid:12640
 kibana pid:
 logstash pid:12683
```

**ES授权（仅第一次需要）**

```bash
./es.sh license
[root@localhost elk-5.4.0]# ./elk.sh license
===========================================
-- ELK 5.4.0 license .. --
-------------------------------------------
the default password is: changeme
Enter host password for user 'elastic':
{"acknowledged":true,"license_status":"valid"}[root@skynet203 elk-5.4.0]#
```

**ELK重启（授权后需要重启）**

```bash
[root@localhost elk-5.4.0]# ./elk.sh stop
[root@localhost elk-5.4.0]# ./elk.sh start
```

**ELK命令说明**

## kibana监控

